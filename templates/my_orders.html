{% extends "base.html" %}
{% block title %}My Orders{% endblock %}
{% block content %}
<h2 class="mb-4">My Order History</h2>

{% for order in orders %}
<div class="card mb-3 shadow-sm">
    <div class="card-header bg-body-tertiary d-flex justify-content-between align-items-center">
        <div>
            <strong>Order #{{ order.id }}</strong> - {{ order.date }}
            {% if order.status == 'Cancelled' %}
                <span class="badge bg-danger">Cancelled</span>
            {% elif order.status == 'Shipped' %}
                <span class="badge bg-success">Shipped</span>
            {% else %}
                <span class="badge bg-warning text-dark">Pending</span>
            {% endif %}
        </div>

        {% if order.status == 'Pending' %}
            <a href="{{ url_for('cancel_order', order_id=order.id) }}" 
               class="btn btn-outline-danger btn-sm"
               onclick="return confirm('Are you sure you want to cancel this order?');">
                Cancel Order
            </a>
        {% endif %}
    </div>
    <div class="card-body">
        <ul>
            {% for item in order.items %}
                <li>{{ item.quantity }}x Product ID: {{ item.product_id }}</li> 
                {% endfor %}
        </ul>
        <h5 class="mt-2 text-end">Total: ${{ "%.2f"|format(order.total_price / 100) }}</h5>
    </div>
</div>
{% else %}
    <p>You haven't bought anything yet!</p>
{% endfor %}

{% endblock %}